class Solution {
public:
    int kthSmallest(vector<vector<int>>& matrix, int k) {
        priority_queue<
            pair<int, pair<int, int>>,
            vector<pair<int, pair<int, int>>>,
            greater<pair<int, pair<int, int>>>
        > heap;

        int n = matrix.size();
        if (n == 0) return 0;

        vector<vector<bool>> seen(n, vector<bool>(n, false));
        heap.push({matrix[0][0], {0, 0}});
        seen[0][0] = true; 

        while (!heap.empty() && k) {
            auto temp = heap.top(); heap.pop();
            int val = temp.first;
            int x = temp.second.first, y = temp.second.second;
            if (--k == 0) return val;

            if (x + 1 < n && !seen[x + 1][y]) {
                heap.push({matrix[x + 1][y], {x + 1, y}});
                seen[x + 1][y] = true; 
            }
            if (y + 1 < n && !seen[x][y + 1]) {
                heap.push({matrix[x][y + 1], {x, y + 1}});
                seen[x][y + 1] = true; 
            }
        }
        return 0;
    }
};
